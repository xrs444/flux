# Core infrastructure controllers for the HomeProd K3s cluster
# These services are deployed before applications and configs
# Order: Helm repos → CNI → Cert-Manager → Ingress → Storage
---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
metadata:
  name: infra-controllers
  namespace: flux-system
resources:
  - ./helmrepositories/     # External Helm chart repositories
  - ./cert-manager/         # TLS certificate management
  - ./cilium/               # CNI and network policies
  - ./longhorn/             # Distributed block storage
  - ./nfs-mounter/          # NFS mounter for external storage on nodes
  - ./sealedsecrets/        # Encrypted secrets for GitOps
  - ./traefik/              # Ingress controller with OAuth2
  - ./traefik-crds/         # Traefik Custom Resource Definitions
  - ./charts/               # Infrastructure Helm charts
  - ./shared-secrets/       # Secrets for cross-namespace sharing
