apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: ciliumendpoints.cilium.io
spec:
  group: cilium.io
  names:
    plural: ciliumendpoints
    singular: ciliumendpoint
    shortNames:
      - cep
      - ciliumep
    kind: CiliumEndpoint
    listKind: CiliumEndpointList
    categories:
      - cilium
  scope: Namespaced
  versions:
    - name: v2
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          description: CiliumEndpoint is the status of a Cilium policy rule.
          type: object
          required:
            - metadata
          properties:
            apiVersion:
              description: >-
                APIVersion defines the versioned schema of this representation of an object.

                Servers should convert recognized schemas to the latest internal value, and

                may reject unrecognized values.

                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
              type: string
            kind:
              description: >-
                Kind is a string value representing the REST resource this object represents.

                Servers may infer this from the endpoint the client submits requests to.

                Cannot be updated.

                In CamelCase.

                More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
              type: string
            metadata:
              type: object
            status:
              description: EndpointStatus is the status of a Cilium endpoint.
              type: object
              properties:
                controllers:
                  description: >-
                    Controllers is the list of failing controllers for this endpoint.
                  type: array
                  items:
                    description: ControllerStatus is the status of a failing controller.
                    type: object
                    properties:
                      configuration:
                        description: Configuration is the controller configuration
                        type: object
                        properties:
                          error-retry:
                            description: Retry on error
                            type: boolean
                          error-retry-base:
                            description: |-
                              Base error retry back-off time
                              Format: duration
                            type: integer
                            format: int64
                          interval:
                            description: |-
                              Regular synchronization interval
                              Format: duration
                            type: integer
                            format: int64
                      name:
                        description: Name is the name of the controller
                        type: string
                      status:
                        description: Status is the status of the controller
                        type: object
                        properties:
                          consecutive-failure-count:
                            type: integer
                            format: int64
                          failure-count:
                            type: integer
                            format: int64
                          last-failure-msg:
                            type: string
                          last-failure-timestamp:
                            type: string
                          last-success-timestamp:
                            type: string
                          success-count:
                            type: integer
                            format: int64
                      uuid:
                        description: UUID is the UUID of the controller
                        type: string
                encryption:
                  description: Encryption is the encryption configuration of the node
                  type: object
                  properties:
                    key:
                      description: >-
                        Key is the index to the key to use for encryption or 0 if encryption is

                        disabled.
                      type: integer
                external-identifiers:
                  description: >-
                    ExternalIdentifiers is a set of identifiers to identify the endpoint

                    apart from the pod name. This includes container runtime IDs.
                  type: object
                  properties:
                    cni-attachment-id:
                      description: ID assigned to this attachment by container runtime
                      type: string
                    container-id:
                      description: >-
                        ID assigned by container runtime (deprecated, may not be unique)
                      type: string
                    container-name:
                      description: >-
                        Name assigned to container (deprecated, may not be unique)
                      type: string
                    docker-endpoint-id:
                      description: Docker endpoint ID
                      type: string
                    docker-network-id:
                      description: Docker network ID
                      type: string
                    k8s-namespace:
                      description: >-
                        K8s namespace for this endpoint (deprecated, may not be unique)
                      type: string
                    k8s-pod-name:
                      description: >-
                        K8s pod name for this endpoint (deprecated, may not be unique)
                      type: string
                    pod-name:
                      description: >-
                        K8s pod for this endpoint (deprecated, may not be unique)
                      type: string
                health:
                  description: Health is the overall endpoint & subcomponent health.
                  type: object
                  properties:
                    bpf:
                      description: bpf
                      type: string
                    connected:
                      description: Is this endpoint reachable
                      type: boolean
                    overallHealth:
                      description: overall health
                      type: string
                    policy:
                      description: policy
                      type: string
                id:
                  description: ID is the cilium-agent-local ID of the endpoint.
                  type: integer
                  format: int64
                identity:
                  description: >-
                    Identity is the security identity associated with the endpoint
                  type: object
                  properties:
                    id:
                      description: ID is the numeric identity of the endpoint
                      type: integer
                      format: int64
                    labels:
                      description: >-
                        Labels is the list of labels associated with the identity
                      type: array
                      items:
                        type: string
                log:
                  description: >-
                    Log is the list of the last few warning and error log entries
                  type: array
                  items:
                    description: |-
                      EndpointStatusChange Indication of a change of status

                      swagger:model EndpointStatusChange
                    type: object
                    properties:
                      code:
                        description: |-
                          Code indicate type of status change
                          Enum: ["ok","failed"]
                        type: string
                      message:
                        description: Status message
                        type: string
                      state:
                        description: state
                        type: string
                      timestamp:
                        description: Timestamp when status change occurred
                        type: string
                named-ports:
                  description: >-
                    NamedPorts List of named Layer 4 port and protocol pairs which will be used in Network

                    Policy specs.


                    swagger:model NamedPorts
                  type: array
                  items:
                    description: |-
                      Port Layer 4 port / protocol pair

                      swagger:model Port
                    type: object
                    properties:
                      name:
                        description: Optional layer 4 port name
                        type: string
                      port:
                        description: Layer 4 port number
                        type: integer
                      protocol:
                        description: |-
                          Layer 4 protocol
                          Enum: ["TCP","UDP","SCTP","ICMP","ICMPV6","ANY"]
                        type: string
                networking:
                  description: Networking is the networking properties of the endpoint.
                  type: object
                  required:
                    - addressing
                  properties:
                    addressing:
                      description: IP4/6 addresses assigned to this Endpoint
                      type: array
                      items:
                        description: AddressPair is a pair of IPv4 and/or IPv6 address.
                        type: object
                        properties:
                          ipv4:
                            type: string
                          ipv6:
                            type: string
                    node:
                      description: >-
                        NodeIP is the IP of the node the endpoint is running on. The IP must

                        be reachable between nodes.
                      type: string
                policy:
                  description: >-
                    EndpointPolicy represents the endpoint's policy by listing all allowed

                    ingress and egress identities in combination with L4 port and protocol.
                  type: object
                  properties:
                    egress:
                      description: >-
                        EndpointPolicyDirection is the list of allowed identities per direction.
                      type: object
                      required:
                        - enforcing
                      properties:
                        adding:
                          description: Deprecated
                          type: array
                          items:
                            description: >-
                              IdentityTuple specifies a peer by identity, destination port and protocol.
                            type: object
                            properties:
                              dest-port:
                                type: integer
                              identity:
                                type: integer
                                format: int64
                              identity-labels:
                                type: object
                                additionalProperties:
                                  type: string
                              protocol:
                                type: integer
                        allowed:
                          description: >-
                            AllowedIdentityList is a list of IdentityTuples that species peers that are

                            allowed.
                          type: array
                          items:
                            description: >-
                              IdentityTuple specifies a peer by identity, destination port and protocol.
                            type: object
                            properties:
                              dest-port:
                                type: integer
                              identity:
                                type: integer
                                format: int64
                              identity-labels:
                                type: object
                                additionalProperties:
                                  type: string
                              protocol:
                                type: integer
                        denied:
                          description: >-
                            DenyIdentityList is a list of IdentityTuples that species peers that are

                            denied.
                          type: array
                          items:
                            description: >-
                              IdentityTuple specifies a peer by identity, destination port and protocol.
                            type: object
                            properties:
                              dest-port:
                                type: integer
                              identity:
                                type: integer
                                format: int64
                              identity-labels:
                                type: object
                                additionalProperties:
                                  type: string
                              protocol:
                                type: integer
                        enforcing:
                          type: boolean
                        removing:
                          description: Deprecated
                          type: array
                          items:
                            description: >-
                              IdentityTuple specifies a peer by identity, destination port and protocol.
                            type: object
                            properties:
                              dest-port:
                                type: integer
                              identity:
                                type: integer
                                format: int64
                              identity-labels:
                                type: object
                                additionalProperties:
                                  type: string
                              protocol:
                                type: integer
                        state:
                          description: >-
                            EndpointPolicyState defines the state of the Policy mode: "enforcing", "non-enforcing", "disabled"
                          type: string
                    ingress:
                      description: >-
                        EndpointPolicyDirection is the list of allowed identities per direction.
                      type: object
                      required:
                        - enforcing
                      properties:
                        adding:
                          description: Deprecated
                          type: array
                          items:
                            description: >-
                              IdentityTuple specifies a peer by identity, destination port and protocol.
                            type: object
                            properties:
                              dest-port:
                                type: integer
                              identity:
                                type: integer
                                format: int64
                              identity-labels:
                                type: object
                                additionalProperties:
                                  type: string
                              protocol:
                                type: integer
                        allowed:
                          description: >-
                            AllowedIdentityList is a list of IdentityTuples that species peers that are

                            allowed.
                          type: array
                          items:
                            description: >-
                              IdentityTuple specifies a peer by identity, destination port and protocol.
                            type: object
                            properties:
                              dest-port:
                                type: integer
                              identity:
                                type: integer
                                format: int64
                              identity-labels:
                                type: object
                                additionalProperties:
                                  type: string
                              protocol:
                                type: integer
                        denied:
                          description: >-
                            DenyIdentityList is a list of IdentityTuples that species peers that are

                            denied.
                          type: array
                          items:
                            description: >-
                              IdentityTuple specifies a peer by identity, destination port and protocol.
                            type: object
                            properties:
                              dest-port:
                                type: integer
                              identity:
                                type: integer
                                format: int64
                              identity-labels:
                                type: object
                                additionalProperties:
                                  type: string
                              protocol:
                                type: integer
                        enforcing:
                          type: boolean
                        removing:
                          description: Deprecated
                          type: array
                          items:
                            description: >-
                              IdentityTuple specifies a peer by identity, destination port and protocol.
                            type: object
                            properties:
                              dest-port:
                                type: integer
                              identity:
                                type: integer
                                format: int64
                              identity-labels:
                                type: object
                                additionalProperties:
                                  type: string
                              protocol:
                                type: integer
                        state:
                          description: >-
                            EndpointPolicyState defines the state of the Policy mode: "enforcing", "non-enforcing", "disabled"
                          type: string
                state:
                  description: State is the state of the endpoint.
                  type: string
                  enum:
                    - creating
                    - waiting-for-identity
                    - not-ready
                    - waiting-to-regenerate
                    - regenerating
                    - restoring
                    - ready
                    - disconnecting
                    - disconnected
                    - invalid
      subresources: {}
      additionalPrinterColumns:
        - name: Security Identity
          type: integer
          description: Security Identity
          jsonPath: .status.identity.id
        - name: Ingress Enforcement
          type: string
          description: Ingress enforcement in the endpoint
          priority: 1
          jsonPath: .status.policy.ingress.state
        - name: Egress Enforcement
          type: string
          description: Egress enforcement in the endpoint
          priority: 1
          jsonPath: .status.policy.egress.state
        - name: Endpoint State
          type: string
          description: Endpoint current state
          jsonPath: .status.state
        - name: IPv4
          type: string
          description: Endpoint IPv4 address
          jsonPath: .status.networking.addressing[0].ipv4
        - name: IPv6
          type: string
          description: Endpoint IPv6 address
          jsonPath: .status.networking.addressing[0].ipv6
  conversion:
    strategy: None
status:
  conditions:
    - type: NamesAccepted
      status: 'True'
      lastTransitionTime: '2025-06-17T01:15:29Z'
      reason: NoConflicts
      message: no conflicts found
    - type: Established
      status: 'True'
      lastTransitionTime: '2025-06-17T01:15:29Z'
      reason: InitialNamesAccepted
      message: the initial names have been accepted
  acceptedNames:
    plural: ciliumendpoints
    singular: ciliumendpoint
    shortNames:
      - cep
      - ciliumep
    kind: CiliumEndpoint
    listKind: CiliumEndpointList
    categories:
      - cilium
  storedVersions:
    - v2
